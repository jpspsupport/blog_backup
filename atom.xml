<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan SharePoint Support Blog</title>
  
  <subtitle>日本マイクロソフトの SharePoint に関するサポート情報のブログです。</subtitle>
  <link href="/blog/atom.xml" rel="self"/>
  
  <link href="https://jpspsupport.github.io/blog/"/>
  <updated>2021-03-29T12:33:29.756Z</updated>
  <id>https://jpspsupport.github.io/blog/</id>
  
  <author>
    <name>SharePoint Support Japan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>TLS 1.0 や 1.1 廃止による TokenHelper アプリ専用トークン取得動作への影響について</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/impact-of-tokenhelper-from-disabling-tls1.0/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/impact-of-tokenhelper-from-disabling-tls1.0/</id>
    <published>2021-03-24T15:00:00.000Z</published>
    <updated>2021-03-29T12:33:29.756Z</updated>
    
    <content type="html"><![CDATA[<p>Microsoft 365 においては、メッセージ センターや各公開情報に記載の通り、TLS 1.0 と 1.1 を廃止し、新しい暗号化技術を基準とすることで、お客様データのセキュリティ保護を向上する動きを拡大しております。<br>全世界のお客様を想定すると一部に限定されることを想定してはおりますが、特に旧バージョンのオペレーティング システムや .NET Framework (4.5 以下) 基盤をご利用の場合は、ご自身のシステムが影響を受けないか今一度ご確認ください。</p><p>一般的な HTTPS 通信においては、トランスポート層において TLS プロトコルはクライアントとサーバーで対応バージョン等の情報を交換し、ハンドシェイクを実施します。該当処理の確立後は、当該暗号化技術の上で上位層 (アプリケーション層を含む) の通信を開始していく流れです。<br>TLS 1.0 や 1.1 が廃止が適応されると、クライアントから TLS 1.0 を要求した際に、Microsoft 365 の各種サーバーがこれを拒否し、トランスポート層で通信が遮断される動作となります。</p><p>このような遮断を受けた時、.NET アプリケーション側で確認する典型的なエラーは以下となります。</p><h3 id="典型的な例外の例"><a href="#典型的な例外の例" class="headerlink" title="典型的な例外の例"></a>典型的な例外の例</h3><p><code>System.Net.WebException: The underlying connection was closed: An unexpected error occurred on a send. --&gt; System.IO.IOException: Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host. --&gt; System.Net.Sockets.SocketException: An existing connection was forcibly closed by the remote host.</code></p><p>HttpWebRequest.GetResponse メソッドや、Client Side Object Model (CSOM) などでは、上記のようなエラーで、通信が遮断される動作が想定されます。<br>なお、TokenHelper などでアプリ専用トークンをご利用の場合は、少し異なったエラーが発生します。</p><h3 id="TokenHelper-アプリ専用トークン取得時の例"><a href="#TokenHelper-アプリ専用トークン取得時の例" class="headerlink" title="TokenHelper アプリ専用トークン取得時の例"></a>TokenHelper アプリ専用トークン取得時の例</h3><p><code>Microsoft.IdentityModel.SecurityTokenService.RequestFailedException: Token request failed. ---&gt; System.Net.WebException: The remote server returned an error: (401) Unauthorized.at System.Net.HttpWebRequest.GetResponse() at Microsoft.IdentityModel.S2S.Protocols.OAuth2.OAuth2WebRequest.GetResponse() at Microsoft.IdentityModel.S2S.Protocols.OAuth2.OAuth2S2SClient.Issue(String securityTokenServiceUrl OAuth2AccessTokenRequest oauth2Request) --- End of inner exception stack trace --- at Microsoft.IdentityModel.S2S.Protocols.OAuth2.OAuth2S2SClient.Issue(String securityTokenServiceUrl OAuth2AccessTokenRequest oauth2Request) at SampleNameSpace.TokenHelper.GetAppOnlyAccessToken(String targetPrincipalName String targetHost String targetRealm)</code></p><p>上記エラーが発生したとしても、対処方法としては TLS 1.2 を有効化する対応を実施ください。</p><h3 id="対処策"><a href="#対処策" class="headerlink" title="対処策"></a>対処策</h3><p>公開情報ご確認の上、上記のようなエラーが発生した場合は TLS 1.0 および 1.1 無効化による影響を疑い、対処を実施ください。</p><p>タイトル : TLS 1.2 を有効にする方法<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/mem/configmgr/core/plan-design/security/enable-tls-1-2" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/mem/configmgr/core/plan-design/security/enable-tls-1-2</a></p><p>なお、Azure App Service 上のアプリで .NET Framework 4.5 以下をご使用の場合は、対象のフレームワークバージョンを 4.6 以上に上げることが推奨です。<br>ただし、参照アセンブリ等、依存関係の理由により難しい場合は、以下のコードを一行だけアプリケーションのなるべく早い段階の処理として加えることをお勧めします。<br>下記更新対象の値は static プロパティとしてアプリケーション全体をスコープとして影響し、アウトバウンドの TLS バージョンを 1.2 に指定します。 </p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12;</span><br></pre></td></tr></table></figure><h3 id="詳細説明"><a href="#詳細説明" class="headerlink" title="詳細説明"></a>詳細説明</h3><p>TokenHelper では、Realm を取得し、ClientID, ClientSecret および Realm を使用して、アクセストークンを取得する流れとなります。</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Get the realm for the URL</span></span><br><span class="line"><span class="keyword">string</span> realm = TokenHelper.GetRealmFromTargetUrl(<span class="keyword">new</span> Uri(siteUrl));</span><br><span class="line"></span><br><span class="line"><span class="comment">//Get the access token for the URL.  </span></span><br><span class="line"><span class="keyword">string</span> accessToken = TokenHelper.GetAppOnlyAccessToken(TokenHelper.SharePointPrincipal, <span class="keyword">new</span> Uri(siteUrl).Authority, realm).AccessToken;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Create a client context object based on the retrieved access token</span></span><br><span class="line"><span class="keyword">using</span> (ClientContext cc = TokenHelper.GetClientContextWithAccessToken(siteUrl, accessToken))</span><br><span class="line">&#123;</span><br><span class="line">    cc.Load(cc.Web, p =&gt; p.Title);</span><br><span class="line">    cc.ExecuteQuery();</span><br><span class="line">    Console.WriteLine(cc.Web.Title);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>エラーが発生する流れとして、まずは TLS によりトランスポート層で拒否されることにより、TokenHelper.GetReamFromTargetUrl メソッド内で上記典型的な例外 : WebException (内部例外は IOException と SocketException) が返されます。<br>しかし、GetRealmFromTargetUrl メソッドは WebException をメソッド外部にスローしない実装です。該当リクエストは HTTP 応答 401 が返ることを想定したコードであるため、内部で例外を補足し、HTTP 応答ヘッダー WWW-Authenticate の値から Realm の情報を読み取ろうとします。</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> <span class="title">GetRealmFromTargetUrl</span>(<span class="params">Uri targetApplicationUri</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">WebRequest request = WebRequest.Create(targetApplicationUri + <span class="string">"/_vti_bin/client.svc"</span>);</span><br><span class="line">request.Headers.Add(<span class="string">"Authorization: Bearer "</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">using</span> (request.GetResponse())</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (WebException e)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (e.Response == <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">string</span> bearerResponseHeader = e.Response.Headers[<span class="string">"WWW-Authenticate"</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">string</span>.IsNullOrEmpty(bearerResponseHeader))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">string</span> bearer = <span class="string">"Bearer realm=\""</span>;</span><br><span class="line"><span class="keyword">int</span> bearerIndex = bearerResponseHeader.IndexOf(bearer, StringComparison.Ordinal);</span><br><span class="line"><span class="keyword">if</span> (bearerIndex &lt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> realmIndex = bearerIndex + bearer.Length;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (bearerResponseHeader.Length &gt;= realmIndex + <span class="number">36</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">string</span> targetRealm = bearerResponseHeader.Substring(realmIndex, <span class="number">36</span>);</span><br><span class="line"></span><br><span class="line">Guid realmGuid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (Guid.TryParse(targetRealm, <span class="keyword">out</span> realmGuid))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> targetRealm;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>しかし、トランスポート層で通信が拒否されます。アプリケーション層での通信は実行されないため、SharePoint Online サーバーから HTTP 応答ヘッダー WWW-Authenticate などの値は返されません。このことにより例外オブジェクトの HTTP ヘッダーから Realm が取得できず、Realm が null として返されます。</p><p>その結果、次の GetAppOnlyAccessToken メソッドに targetRealm が null が渡されます。<br>ACS に渡されるクライアント ID は、ClientID@Realm の形式で渡されます。この値が不正な形式 (ClientID@) となるため、HTTP 応答コード 401 と共に RequestFailedException が返されます。</p><p>もちろん、RequestFailedException 単体を見た場合、アプリケーションへの変更により、Client ID が使用できなくなった場合や、Client Secret の有効期限が切れた等の別事象も切り分ける必要はあります。<br>その際には、最新の Windows 端末等より、Connect-PnPOnline コマンドを実行して、アプリ定義自体に問題がないことを切り分けるのも有効な手段です。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connect-PnPOnline https://&#123;tenant&#125;.sharepoint.com -ClientId &lt;クライアント ID&gt; -ClientSecret &lt;クライアント シークレット&gt;</span><br></pre></td></tr></table></figure><h2 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h2><p>タイトル : Microsoft 365 の TLS 1.0 と 1.1 を無効にする<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/microsoft-365/compliance/tls-1.0-and-1.1-deprecation-for-office-365?view=o365-worldwide" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/microsoft-365/compliance/tls-1.0-and-1.1-deprecation-for-office-365?view=o365-worldwide</a></p><p>タイトル : Office 365 および Office 365 GCC での TLS 1.2 の準備<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/microsoft-365/compliance/prepare-tls-1.2-in-office-365?view=o365-worldwide" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/microsoft-365/compliance/prepare-tls-1.2-in-office-365?view=o365-worldwide</a></p><p>今回の投稿は以上です。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Microsoft 365 においては、メッセージ センターや各公開情報に記載の通り、TLS 1.0 と 1.1 を廃止し、新しい暗号化技術を基準とすることで、お客様データのセキュリティ保護を向上する動きを拡大しております。&lt;br&gt;全世界のお客様を想定すると一部に限定される
      
    
    </summary>
    
    
    
      <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate で SharePoint リスト アイテムに対して個別のアクセス権を付与する方法</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/power-automate-assign-permission/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/power-automate-assign-permission/</id>
    <published>2020-07-13T15:00:00.000Z</published>
    <updated>2021-03-29T12:33:29.760Z</updated>
    
    <content type="html"><![CDATA[<p>今回の投稿では、SharePoint Online における <a href="https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&rs=ja-jp&ad=jp" target="_blank" rel="noopener">SharePoint 2010 形式ワークフローの廃止</a> (MC217999) に際して、移行先となる Power Automate を簡単に紹介します。</p><p>移行プロジェクトにおいて、最も技術的な懸案事項に指定されているものに、個別アクセス権の付与が数多く上げられております。アイテムごとにアクセス権を付与する運用は、パフォーマンスを考慮した場合は得策ではありません。しかしながら、多くのユーザーが SharePoint 2010 形式ワークフローを利用する一つの根強い理由として挙げられているため、ここに Power Automate による回避策を記載します。</p><p>なお、前提として <a href="https://docs.microsoft.com/ja-jp/office365/servicedescriptions/sharepoint-online-service-description/sharepoint-online-limits" target="_blank" rel="noopener">SharePoint の制限</a> には、リストまたはライブラリ内のアイテムに対する固有の権限は 5,000 までと指定されております。そのため、固有のアクセス権を割り当てる運用を実施する場合、リストまたはライブラリ内のアイテムが 5,000 を超えないようキャパシティ プランをお願いします。</p><h2 id="公開情報より"><a href="#公開情報より" class="headerlink" title="公開情報より"></a>公開情報より</h2><p>公開情報には、アイテムまたはフォルダーへのアクセスを許可する、中止するといったアクションに対して、条件付きで可能との記載があります。</p><p>タイトル : Guidance: Migrate from classic workflows to Power Automate flows in SharePoint<br>アドレス : <a href="https://docs.microsoft.com/en-us/sharepoint/dev/business-apps/power-automate/guidance/migrate-from-classic-workflows-to-power-automate-flows" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/sharepoint/dev/business-apps/power-automate/guidance/migrate-from-classic-workflows-to-power-automate-flows</a></p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM00.png"><p>モダン UI のアクセス許可もクラシックのアクセス許可に影響するので、特に大きな問題はありません。以下のように落ち着いてソリューションを実施しましょう。</p><h2 id="ウォークスルー"><a href="#ウォークスルー" class="headerlink" title="ウォークスルー"></a>ウォークスルー</h2><h3 id="1-まずは、モダン-UI-のリストやライブラリから、-自動化-–-Power-Automate-–-フローの作成-よりフローを作成していきます。"><a href="#1-まずは、モダン-UI-のリストやライブラリから、-自動化-–-Power-Automate-–-フローの作成-よりフローを作成していきます。" class="headerlink" title="1. まずは、モダン UI のリストやライブラリから、[自動化] – [Power Automate] – [フローの作成] よりフローを作成していきます。"></a>1. まずは、モダン UI のリストやライブラリから、[自動化] – [Power Automate] – [フローの作成] よりフローを作成していきます。</h3><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM01.png"><h3 id="2-フローの作成ペインにて、-詳細の表示-–-既存の-SharePoint-リスト項目が修正されたときに、カスタム-アクションを完了する-をクリックします。"><a href="#2-フローの作成ペインにて、-詳細の表示-–-既存の-SharePoint-リスト項目が修正されたときに、カスタム-アクションを完了する-をクリックします。" class="headerlink" title="2. フローの作成ペインにて、[詳細の表示] – [既存の SharePoint リスト項目が修正されたときに、カスタム アクションを完了する] をクリックします。"></a>2. フローの作成ペインにて、[詳細の表示] – [既存の SharePoint リスト項目が修正されたときに、カスタム アクションを完了する] をクリックします。</h3><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM02.png"><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM03.png"><h3 id="3-続行-をクリックします。"><a href="#3-続行-をクリックします。" class="headerlink" title="3. [続行] をクリックします。"></a>3. [続行] をクリックします。</h3><p>画像ではマスクしていますが、ここに表示されるユーザーの権限で処理が実行されます。<br>サイト コレクションの管理者権限等、十分なアクセス権をフローの作成者に与えてください。</p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM04.png"><h3 id="4-フローの編集画面に遷移しました。-新しいステップ-をクリックして後続の処理を追加していきます。"><a href="#4-フローの編集画面に遷移しました。-新しいステップ-をクリックして後続の処理を追加していきます。" class="headerlink" title="4. フローの編集画面に遷移しました。[+ 新しいステップ] をクリックして後続の処理を追加していきます。"></a>4. フローの編集画面に遷移しました。[+ 新しいステップ] をクリックして後続の処理を追加していきます。</h3><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM05.png"><h3 id="5-親のアクセス権を継承しない場合は、-アイテムまたはファイルの共有を停止します-を選択します。"><a href="#5-親のアクセス権を継承しない場合は、-アイテムまたはファイルの共有を停止します-を選択します。" class="headerlink" title="5. 親のアクセス権を継承しない場合は、[アイテムまたはファイルの共有を停止します] を選択します。"></a>5. 親のアクセス権を継承しない場合は、[アイテムまたはファイルの共有を停止します] を選択します。</h3><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM06.png"><h3 id="6-“リストまたはライブラリ”-と-“ID”-に動的なコンテンツ-値-を設定します。"><a href="#6-“リストまたはライブラリ”-と-“ID”-に動的なコンテンツ-値-を設定します。" class="headerlink" title="6. “リストまたはライブラリ” と “ID” に動的なコンテンツ (値) を設定します。"></a>6. “リストまたはライブラリ” と “ID” に動的なコンテンツ (値) を設定します。</h3><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM07.png"><h3 id="7-実際にアクセス権を適用していきます。アクション選択画面で-アイテムまたはフォルダーへのアクセス権の付与-をクリックします。"><a href="#7-実際にアクセス権を適用していきます。アクション選択画面で-アイテムまたはフォルダーへのアクセス権の付与-をクリックします。" class="headerlink" title="7. 実際にアクセス権を適用していきます。アクション選択画面で [アイテムまたはフォルダーへのアクセス権の付与] をクリックします。"></a>7. 実際にアクセス権を適用していきます。アクション選択画面で [アイテムまたはフォルダーへのアクセス権の付与] をクリックします。</h3><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM08.png"><h3 id="8-受信者にはアクセス権を与えるユーザーを指定し、ロールには権限レベルを指定します。"><a href="#8-受信者にはアクセス権を与えるユーザーを指定し、ロールには権限レベルを指定します。" class="headerlink" title="8. 受信者にはアクセス権を与えるユーザーを指定し、ロールには権限レベルを指定します。"></a>8. 受信者にはアクセス権を与えるユーザーを指定し、ロールには権限レベルを指定します。</h3><p>この例では、リストに追加されたユーザー列である、”共同編集者” を動的なコンテンツ (値) から指定しています。<br>ロールとしては、Can edit と Can view のいずれかをプルダウンから選択します。</p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM09.png"><p>これで、最低限アクセス許可を与えるフローの作成は完成です。</p><h2 id="編集や閲覧以外のアクセス許可を付与する方法"><a href="#編集や閲覧以外のアクセス許可を付与する方法" class="headerlink" title="編集や閲覧以外のアクセス許可を付与する方法"></a>編集や閲覧以外のアクセス許可を付与する方法</h2><p>アクション側の入力項目において、ロールには Can edit と Can View が 2 択で表示されますが、[カスタム値の入力] をクリックして、他のアクセス権 (ロール) を付与することは可能であることを確認しています。</p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM10.png"><p>この部分のみ、少し複雑な手順となりますが、併せて以下に記載します。</p><h3 id="1-必要とするロール定義の-ID-を取得します。"><a href="#1-必要とするロール定義の-ID-を取得します。" class="headerlink" title="1. 必要とするロール定義の ID を取得します。"></a>1. 必要とするロール定義の ID を取得します。</h3><p>以下の a か b のいずれかの方法をご利用ください。</p><h4 id="a-PowerShell-を使用する場合"><a href="#a-PowerShell-を使用する場合" class="headerlink" title="a. PowerShell を使用する場合"></a>a. PowerShell を使用する場合</h4><p>a-1. PnP PowerShell をお持ちでない場合は<a href="https://docs.microsoft.com/ja-jp/powershell/sharepoint/sharepoint-pnp/sharepoint-pnp-cmdlets?view=sharepoint-ps" target="_blank" rel="noopener">入手</a>します。<br>a-2. Connect-PnPOnline &lt;サイト URL&gt; を実行します。<br>a-3. Get-PnPRoleDefinition を実行して、サイトに存在するロールの定義を一覧表示します。<br>a-4. Get-PnPRoleDefinition -Identity &lt;ロール名&gt; | select Id を実行して Id を抜き出します。</p><p>以下の例では、フルコントロールの Id として 1073741829 を取得します。</p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM11.png"><h4 id="b-REST-を使用する場合"><a href="#b-REST-を使用する場合" class="headerlink" title="b. REST を使用する場合"></a>b. REST を使用する場合</h4><p>b-1. ブラウザーで SharePoint のページを表示します。<br>b-2. サイト URL 配下を以下のように変更します。<br><a href="https://tenant.sharepoint.com/sites/site/_api/web/roledefinitions" target="_blank" rel="noopener">https://tenant.sharepoint.com/sites/site/_api/web/roledefinitions</a><br>b-3. XML でロール名が表示されるので、ロール名に対応する Id を取得します。</p><p>以下の例では “フル コントロール” の ID として 1073741829 を取得します。</p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM12.png"><p>IE などのブラウザーでは、フィード画面が表示される場合があります。その場合、[Alt] キーを押し、[ファイル] - [名前を付けて保存] をクリックして結果をローカル ファイルに保存すると、ブラウザー側に返されている XML のデータが保存されます。</p><h3 id="2-“アイテムまたはフォルダーへのアクセス権の付与”-のアクションにて、role-ID-値-を文字列で指定します。"><a href="#2-“アイテムまたはフォルダーへのアクセス権の付与”-のアクションにて、role-ID-値-を文字列で指定します。" class="headerlink" title="2. “アイテムまたはフォルダーへのアクセス権の付与” のアクションにて、role:ID 値 を文字列で指定します。"></a>2. “アイテムまたはフォルダーへのアクセス権の付与” のアクションにて、role:ID 値 を文字列で指定します。</h3><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM13.png"><h2 id="実行結果"><a href="#実行結果" class="headerlink" title="実行結果"></a>実行結果</h2><p>リストにアイテムを投稿すると、共同編集者列のユーザーにアクセス許可が付与される動作を確認できます。</p><img src="/blog/sharepoint-online/power-automate-assign-permission/PAPERM14.png">]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;今回の投稿では、SharePoint Online における &lt;a href=&quot;https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&amp;rs=ja-jp
      
    
    </summary>
    
    
    
      <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>Power Automate で簡単な承認フローを作成する</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/introduction-to-power-automate/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/introduction-to-power-automate/</id>
    <published>2020-07-09T15:00:00.000Z</published>
    <updated>2021-03-29T12:33:29.756Z</updated>
    
    <content type="html"><![CDATA[<p>今回の投稿では、SharePoint Online における <a href="https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&rs=ja-jp&ad=jp" target="_blank" rel="noopener">SharePoint 2010 形式ワークフローの廃止</a> (MC217999) に際して、移行先となる Power Automate を簡単に紹介します。</p><p>これまで移行先の Power Automate の採用を決定できない一つの要因に、Power Automate に慣れていないことが挙げられていることがあると思います。<br>Power Automate の承認ワークフローを作成する方法は、様々な方々がすでに画面付きで手順を公開しておりますので、新たに作成する方法はないかと当初は考えました。しかしながら、初学の場合においては資料との相性等もあるかと思いますので、少しでも参考資料の選択肢が多い方がいいと思います。</p><p>そこで、本投稿でも手順を紹介します。現行バージョンの Power Automate でのご説明になりますが高度なものは作成せず、シンプルな処理で構成し、細かな操作を説明し、スピーディにキャッチアップできる形を目指します。</p><h2 id="移行シナリオの参考情報"><a href="#移行シナリオの参考情報" class="headerlink" title="移行シナリオの参考情報"></a>移行シナリオの参考情報</h2><p>SharePoint 2010 形式ワークフローからの移行を検討している方には、マイクロソフトからの公開情報としては以下のサイトをご確認いただくことをお勧めします。</p><p>タイトル : Microsoft SharePoint Connector in Power 自動<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/sharepoint-connector-actions-triggers" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/sharepoint-connector-actions-triggers</a></p><p>タイトル : Power 自動化を使用して SharePoint でドキュメントの承認を必須にする<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/guidance/require-doc-approval" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/guidance/require-doc-approval</a></p><p>下記サイトには、SharePoint ワークフローと Power Automate の機能の対比表が含まれています。</p><p>タイトル : ガイダンス: SharePoint で従来のワークフローからパワー自動化フローに移行する<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/guidance/migrate-from-classic-workflows-to-power-automate-flows" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/sharepoint/dev/business-apps/power-automate/guidance/migrate-from-classic-workflows-to-power-automate-flows</a></p><h2 id="ウォークスルー"><a href="#ウォークスルー" class="headerlink" title="ウォークスルー"></a>ウォークスルー</h2><p>それでは、実際に Power Automate で処理を作成していき、操作に慣れることを目指しましょう。</p><h3 id="1-コマンド-バーより-自動化-–-Power-Automate-–-フローの作成-をクリックします。"><a href="#1-コマンド-バーより-自動化-–-Power-Automate-–-フローの作成-をクリックします。" class="headerlink" title="1. コマンド バーより [自動化] – [Power Automate] – [フローの作成] をクリックします。"></a>1. コマンド バーより [自動化] – [Power Automate] – [フローの作成] をクリックします。</h3><p>モダン UI で、リストやライブラリを表示すると、コマンドバーに [自動化] というメニューがあります。SharePoint は、ここからフローの作成を開始できます。</p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA01.png"><h3 id="2-画面右に現れるフローの作成ペインにて-詳細の表示-を展開し、-新しいファイルが-SharePoint-に追加されたときに、カスタムアクションを完了する-をクリックしてフローの作成を開始します。"><a href="#2-画面右に現れるフローの作成ペインにて-詳細の表示-を展開し、-新しいファイルが-SharePoint-に追加されたときに、カスタムアクションを完了する-をクリックしてフローの作成を開始します。" class="headerlink" title="2. 画面右に現れるフローの作成ペインにて [詳細の表示] を展開し、[新しいファイルが SharePoint に追加されたときに、カスタムアクションを完了する] をクリックしてフローの作成を開始します。"></a>2. 画面右に現れるフローの作成ペインにて [詳細の表示] を展開し、[新しいファイルが SharePoint に追加されたときに、カスタムアクションを完了する] をクリックしてフローの作成を開始します。</h3><p>Power Automate では、シナリオに合わせてテンプレートを選択して、フローの作成を行うことができます。<br>そのため、SharePoint へのコネクターや、必要最小限の処理が含まれた状態で、フローを作成できるため生産的です。</p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA02.png"><img src="/blog/sharepoint-online/introduction-to-power-automate/PA03.png"><h3 id="3-続行-をクリックします。"><a href="#3-続行-をクリックします。" class="headerlink" title="3. [続行] をクリックします。"></a>3. [続行] をクリックします。</h3><img src="/blog/sharepoint-online/introduction-to-power-automate/PA04.png"><h3 id="4-フローの編集画面に遷移しました。-新しいステップ-をクリックして後続の処理を追加していきます。"><a href="#4-フローの編集画面に遷移しました。-新しいステップ-をクリックして後続の処理を追加していきます。" class="headerlink" title="4. フローの編集画面に遷移しました。[+ 新しいステップ] をクリックして後続の処理を追加していきます。"></a>4. フローの編集画面に遷移しました。[+ 新しいステップ] をクリックして後続の処理を追加していきます。</h3><p>ライブラリにファイルがアップロードされて処理が開始するという部分ができあがった状態でスタートします。当初の設定値などは、色々と観察してみてください。</p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA05.png"><h4 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h4><p>処理の最後ではなく、途中にアクションを差し込む場合は、アクション間にある線をポイントすると (+) マークが表れます。</p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA06.png"><p>さらに [アクションの追加] を押すと、アクションが挿入できます。</p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA07.png"><h3 id="5-アクション選択画面で-“承認”-を検索し、-開始して承認を待機-を選択します。"><a href="#5-アクション選択画面で-“承認”-を検索し、-開始して承認を待機-を選択します。" class="headerlink" title="5. アクション選択画面で “承認” を検索し、[開始して承認を待機] を選択します。"></a>5. アクション選択画面で “承認” を検索し、[開始して承認を待機] を選択します。</h3><img src="/blog/sharepoint-online/introduction-to-power-automate/PA08.png"><p>アクションについては、画面上側にサービス、下側にトリガーとアクションが表示されます。<br>検索機能はそれぞれに適用されます。ここでは “承認” を検索していますが、”承認” サービスだけではなく、承認というキーワードに該当するアクションを持つ各種サービスと、そのトリガーやアクションがすべて表示されています。<br>どのようなサービス、そしてそのトリガーやアクションが使用できるかは、公開情報を調べても結構ですし、ご自身で色々と検索しながら確認することもできます。</p><h3 id="6-“承認の種類”-にて、”カスタム応答-–-1-つの応答を待機”-をクリックします。"><a href="#6-“承認の種類”-にて、”カスタム応答-–-1-つの応答を待機”-をクリックします。" class="headerlink" title="6. “承認の種類” にて、”カスタム応答 – 1 つの応答を待機” をクリックします。"></a>6. “承認の種類” にて、”カスタム応答 – 1 つの応答を待機” をクリックします。</h3><img src="/blog/sharepoint-online/introduction-to-power-automate/PA09.png"><h3 id="7-“開始して承認を待機”-アクションの詳細を指定していきます。"><a href="#7-“開始して承認を待機”-アクションの詳細を指定していきます。" class="headerlink" title="7. “開始して承認を待機” アクションの詳細を指定していきます。"></a>7. “開始して承認を待機” アクションの詳細を指定していきます。</h3><img src="/blog/sharepoint-online/introduction-to-power-automate/PA10.png"><p>応答オプションには、承認者が選択する応答の選択肢 (例 承認、却下) を定義します。</p><p>各種エディターについてですが、アクションの各プロパティに直接文字入力をすると文字列の固定値が指定されます。<br>動的なコンテンツ (値) を扱いたい場合は、入力項目にフォーカスを当て、画面右下の吹き出しコンテンツから値を選択して使います。</p><h3 id="8-同じ要領で-新しいステップ-をクリックして-“条件”-アクションを追加します。"><a href="#8-同じ要領で-新しいステップ-をクリックして-“条件”-アクションを追加します。" class="headerlink" title="8. 同じ要領で [+ 新しいステップ] をクリックして “条件” アクションを追加します。"></a>8. 同じ要領で [+ 新しいステップ] をクリックして “条件” アクションを追加します。</h3><img src="/blog/sharepoint-online/introduction-to-power-automate/PA11.png"><h3 id="9-条件の左辺より順に、動的な値から-“応答”-“次の値に等しい”-文字列直接入力にて-“承認”-などと指定します。"><a href="#9-条件の左辺より順に、動的な値から-“応答”-“次の値に等しい”-文字列直接入力にて-“承認”-などと指定します。" class="headerlink" title="9. 条件の左辺より順に、動的な値から “応答”, “次の値に等しい”, 文字列直接入力にて “承認” などと指定します。"></a>9. 条件の左辺より順に、動的な値から “応答”, “次の値に等しい”, 文字列直接入力にて “承認” などと指定します。</h3><img src="/blog/sharepoint-online/introduction-to-power-automate/PA12.png"><p>1 つの応答を待機するモデルであれば、”結果” という値に、承認者が選択した値が入ってきます。<br>この値が “承認” ならば “はい” の方へ、そうでなければ “いいえ” の方に流すようにします。</p><h3 id="10-はい、いいえのそれぞれのブロックにて、-アクションの追加-をクリックし、”項目の更新”-アクションを挿入します。"><a href="#10-はい、いいえのそれぞれのブロックにて、-アクションの追加-をクリックし、”項目の更新”-アクションを挿入します。" class="headerlink" title="10. はい、いいえのそれぞれのブロックにて、[アクションの追加] をクリックし、”項目の更新” アクションを挿入します。"></a>10. はい、いいえのそれぞれのブロックにて、[アクションの追加] をクリックし、”項目の更新” アクションを挿入します。</h3><img src="/blog/sharepoint-online/introduction-to-power-automate/PA13.png"><h3 id="11-それぞれ、承認済みか却下という値を列に書き込むに今回のサンプルはとどめます。"><a href="#11-それぞれ、承認済みか却下という値を列に書き込むに今回のサンプルはとどめます。" class="headerlink" title="11. それぞれ、承認済みか却下という値を列に書き込むに今回のサンプルはとどめます。"></a>11. それぞれ、承認済みか却下という値を列に書き込むに今回のサンプルはとどめます。</h3><img src="/blog/sharepoint-online/introduction-to-power-automate/PA14.png"><h2 id="実行確認"><a href="#実行確認" class="headerlink" title="実行確認"></a>実行確認</h2><p>ユーザー エクスペリエンスを確認してみましょう。</p><p>ファイルをアップロードしてみてください。<br>しばらくすると承認者宛に以下のようなメールが届きます。</p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA15.png"><p>そこで [承認] を選択して、[送信] をクリックすると、承認処理が完了です。</p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA16.png"><p>Result 列に承認済みが記録されました。</p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA17.png"><h2 id="その他、トラブルシューティング等"><a href="#その他、トラブルシューティング等" class="headerlink" title="その他、トラブルシューティング等"></a>その他、トラブルシューティング等</h2><p>エラーがある場合は、フローの編集画面から [左矢印] をクリックして、概要ページ内にある実行履歴をクリックします。<br>この画面内に失敗のエントリーがあれば、それをクリックしてトラブルシューティングすることができます。</p><img src="/blog/sharepoint-online/introduction-to-power-automate/PA18.png"><p>初めてのテクノロジーにおいても、スモール スタートで利用開始し、そこから少しずつテストしながら追加していくことで、ソリューションを作成できるものと考えております。<br>是非移行作業を進める上で、上記資料を準備にお役立てください。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;今回の投稿では、SharePoint Online における &lt;a href=&quot;https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&amp;rs=ja-jp
      
    
    </summary>
    
    
    
      <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>SharePoint Modernization Scanner を使用して、移行対象のワークフローを抽出する</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/use-sp-modernization-scanner/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/use-sp-modernization-scanner/</id>
    <published>2020-07-08T15:00:00.000Z</published>
    <updated>2021-03-29T12:33:29.764Z</updated>
    
    <content type="html"><![CDATA[<p>今回の投稿では、SharePoint Online における <a href="https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&rs=ja-jp&ad=jp" target="_blank" rel="noopener">SharePoint 2010 形式ワークフローの廃止</a> (MC217999) に際しての計画段階において、移行対象のワークフローを抽出する方法を詳細に記載します。</p><p>そのためのツールとして、SharePoint Modernization Scanner (SharePoint モダン化スキャナー) が公開されています。</p><p>最初に、移行する SharePoint 2010 形式ワークフローの全体像をつかむことは必須の作業となります。これをもとに、技術的な課題項目を整理したり、工数を見積もるという作業が派生してくると思います。<br>本投稿では、できる限りスムーズに移行検討作業に移れるよう、現バージョンの SharePoint モダン化スキャナーによる操作イメージを画面付きで紹介します。</p><h2 id="1-最初に下記サイトからツールをダウンロードします。"><a href="#1-最初に下記サイトからツールをダウンロードします。" class="headerlink" title="1. 最初に下記サイトからツールをダウンロードします。"></a>1. 最初に下記サイトからツールをダウンロードします。</h2><p>タイトル : SharePoint モダン化スキャナーを使い始める<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/transform/modernize-scanner" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/sharepoint/dev/transform/modernize-scanner</a></p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS01.png"><h2 id="2-ダウンロードしたツールを実行します。"><a href="#2-ダウンロードしたツールを実行します。" class="headerlink" title="2. ダウンロードしたツールを実行します。"></a>2. ダウンロードしたツールを実行します。</h2><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS02.png"><h3 id="2-1-クライアント-ID-とクライアント-シークレットを用意します。"><a href="#2-1-クライアント-ID-とクライアント-シークレットを用意します。" class="headerlink" title="2-1. クライアント ID とクライアント シークレットを用意します。"></a>2-1. クライアント ID とクライアント シークレットを用意します。</h3><p>Selected Authentication Option ですが、テナント全体に対して実行する場合は、あらかじめテナント内の全サイト コレクションにアクセス可能なユーザーが用意できない場合は、アプリ専用トークンを利用することが現実的です。<br>アプリ専用トークンの種類は 2 種類あります。一般的にはライフサイクルを考慮した場合、継続的なアプリケーションの開発や利用を想定した場合は Azure AD App Only が推奨されますが、どちらでも現時点での機能面に変わりはないため、今回の一時的な利用においては操作が簡単な Azure ACS App Only のシナリオを進めていただくことで問題はありません。</p><p>別途以下のサイトなどの手順で Azure ACS クライアント ID と クライアント シークレットを入手します。</p><p>タイトル : PnP PowerShell でテナントのフルコントロール権限を使用して接続する方法について<br>アドレス : <a href="https://jpspsupport.github.io/blog/sharepoint-online/pnp-powershell-with-app-only-token/">https://jpspsupport.github.io/blog/sharepoint-online/pnp-powershell-with-app-only-token/</a></p><p>なお、上記サイトはテナントに対してフルコントロール権限でアプリを払い出しておりますので、適宜権限要求 XML を変更してサイトに対するフルコントロール等に変更していただいてもかまいません。</p><h3 id="2-2-クライアント-ID-とクライアント-シークレットを入力して-Next-をクリックします"><a href="#2-2-クライアント-ID-とクライアント-シークレットを入力して-Next-をクリックします" class="headerlink" title="2-2. クライアント ID とクライアント シークレットを入力して [Next] をクリックします"></a>2-2. クライアント ID とクライアント シークレットを入力して [Next] をクリックします</h3><h3 id="2-3-対象を指定して-Next-をクリックします。"><a href="#2-3-対象を指定して-Next-をクリックします。" class="headerlink" title="2-3. 対象を指定して [Next] をクリックします。"></a>2-3. 対象を指定して [Next] をクリックします。</h3><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS03.png"><h2 id="3-Scan-mode-には-Classic-workflow-usage-を指定ください。"><a href="#3-Scan-mode-には-Classic-workflow-usage-を指定ください。" class="headerlink" title="3. Scan mode には Classic workflow usage を指定ください。"></a>3. Scan mode には Classic workflow usage を指定ください。</h2><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS04.png"><h2 id="4-最後に細かな設定が可能ですが、-Start-Scan-を押すと開始します。"><a href="#4-最後に細かな設定が可能ですが、-Start-Scan-を押すと開始します。" class="headerlink" title="4.    最後に細かな設定が可能ですが、[Start Scan] を押すと開始します。"></a>4.    最後に細かな設定が可能ですが、[Start Scan] を押すと開始します。</h2><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS04-2.png"><h2 id="5-実行時にはコマンド-プロンプトに進捗が書かれます。"><a href="#5-実行時にはコマンド-プロンプトに進捗が書かれます。" class="headerlink" title="5. 実行時にはコマンド プロンプトに進捗が書かれます。"></a>5. 実行時にはコマンド プロンプトに進捗が書かれます。</h2><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS05.png"><h2 id="6-コマンド実行が完了すると、フォルダーが実行プログラム-EXE-と同一階層に現れます。"><a href="#6-コマンド実行が完了すると、フォルダーが実行プログラム-EXE-と同一階層に現れます。" class="headerlink" title="6. コマンド実行が完了すると、フォルダーが実行プログラム (*.EXE) と同一階層に現れます。"></a>6. コマンド実行が完了すると、フォルダーが実行プログラム (*.EXE) と同一階層に現れます。</h2><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS06.png"><h2 id="7-フォルダー内には以下のようなファイルが入っています。"><a href="#7-フォルダー内には以下のようなファイルが入っています。" class="headerlink" title="7. フォルダー内には以下のようなファイルが入っています。"></a>7. フォルダー内には以下のようなファイルが入っています。</h2><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS07.png"><h2 id="8-ModernizationWorkflowScanResults-csv-を開きます。"><a href="#8-ModernizationWorkflowScanResults-csv-を開きます。" class="headerlink" title="8. ModernizationWorkflowScanResults.csv を開きます。"></a>8. ModernizationWorkflowScanResults.csv を開きます。</h2><p>日本語が含まれる場合は、一度ファイルをメモ帳で開いて、名前を付けて保存し、UTF8 BOM 付きで保存しなおし、その後 Excel で開きます。</p><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS08-1.png"><p>Windows 10 以前の OS をご利用の場合は UTF-8 (BOM 付き) の文字コードが指定できない場合があります。この場合は、UTF-8 として上書き保存すれば明示的に BOM が指定されます。<br>手順 9 で Excel データが文字化けしている場合は、この手順がスキップされていることに起因します。</p><h2 id="9-シート上のセルをテーブルに変換し、フィルターを使用して、置き換え対象のワークフローを絞り込んでいきます。"><a href="#9-シート上のセルをテーブルに変換し、フィルターを使用して、置き換え対象のワークフローを絞り込んでいきます。" class="headerlink" title="9. シート上のセルをテーブルに変換し、フィルターを使用して、置き換え対象のワークフローを絞り込んでいきます。"></a>9. シート上のセルをテーブルに変換し、フィルターを使用して、置き換え対象のワークフローを絞り込んでいきます。</h2><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS09.png"><p>例</p><ul><li>SharePoint 2010 形式ワークフロー (Version = 2010)</li><li>リストで新規インスタンスを許可されている (Enabled = True) </li></ul><img src="/blog/sharepoint-online/use-sp-modernization-scanner/SMS10.png"><p>この時点で、使用中のワークフロー一覧については抽出完了です。<br>サイト コレクション管理者にコンテンツを委任している場合は、各サイト コレクション管理者に MC217999 の内容や告示内容、各サイト コレクションごとの抽出データとあわせ、Admins 列に格納されたユーザーに共有して連携してください。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;今回の投稿では、SharePoint Online における &lt;a href=&quot;https://support.microsoft.com/ja-jp/office/1ca3fff8-9985-410a-85aa-8120f626965f?ui=ja-jp&amp;rs=ja-jp
      
    
    </summary>
    
    
    
      <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>HTTP 調整のリトライロジックのテスト方法</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/Testing-backoff-logic/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/Testing-backoff-logic/</id>
    <published>2020-06-07T15:00:00.000Z</published>
    <updated>2021-03-29T12:33:29.756Z</updated>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>HTTP 調整リトライ ロジックを実装した際に、特に弊社公開記事に記載されたカスタムコードを変更している場合は、論理テストを実施していただく必要があります。</p><p>残念ながら、SharePoint Online に対して明示的に調整を発生させることはできないため、現実的なシナリオに即したテストなどを実施することはできません。<br>テストのためにクラウド側に不要な負荷をかけることも適切ではない行動となります。<br>そのため、基本的には論理テストを実施し、様々な想定シナリオに対するロジック テストをパスした後で、テスト済みのコードをマスターに組み込むという方法が現実的です。</p><p>今回の記事では、その疑似的な論理テストを実施する方法の 1 つをご紹介します。</p><h1 id="対処策"><a href="#対処策" class="headerlink" title="対処策"></a>対処策</h1><p>Fiddler の AutoResponder を使用して、CSOM などの通信に対して、任意の HTTP 応答を返して動作検証する方法があります。</p><p>まず、Fiddler を起動し、トレースを取得しておきます。</p><img src="/blog/sharepoint-online/Testing-backoff-logic/Fiddler1.png"><p>1) 応答を書き換えたい通信を、画面左ペインから選択します。<br>2) [AutoResponder] タブをクリックします。<br>3) Enable Rules と Unmatched requests passthrough がチェックされていることを確認します。<br>4) [Add Rule] をクリックします。</p><p>次に緑の欄の設定に移ります。</p><img src="/blog/sharepoint-online/Testing-backoff-logic/Fiddler2.png"><p>5) Rule Editor の下のセレクトボックスで [Create New Response…] をプルダウンから選択します。<br>6) [Save] をクリックすると、ダイアログがポップアップされます。</p><img src="/blog/sharepoint-online/Testing-backoff-logic/Fiddler3-1.png"><p>7) [Raw] タブをクリックします。<br>8) HTTP 応答のステータス コードに 429 TOO MANY REQUESTS を指定します。<br>9) HTTP 応答ヘッダーに Retry-After を指定して、任意の数値を指定します。<br> テスト用ですので、短い値でも問題ありません。</p><p>10) [Save] をクリックします。<br>11) ダイアログを [x] を押して閉じます。</p><p>この後、Fiddler を起動してロジックをテストしてください。指定された間隔でリトライが実行されることが確認できます。</p><img src="/blog/sharepoint-online/Testing-backoff-logic/Fiddler4.png"><h1 id="参考リンク"><a href="#参考リンク" class="headerlink" title="参考リンク"></a>参考リンク</h1><p>タイトル : SharePoint Online で調整またはブロックを回避する方法<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/general-development/how-to-avoid-getting-throttled-or-blocked-in-sharepoint-online" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/sharepoint/dev/general-development/how-to-avoid-getting-throttled-or-blocked-in-sharepoint-online</a></p><p>タイトル : SharePoint Online の HTTP 調整 (応答コード 429, 503) に関して<br>アドレス : <a href="https://social.msdn.microsoft.com/Forums/ja-JP/8e5a4116-c96a-4d3e-9bbf-6efb852b5d88/sharepoint-online-12398-http-3551925972-2454031572124671254012489-429-503?forum=sharepointsupportteamja" target="_blank" rel="noopener">https://social.msdn.microsoft.com/Forums/ja-JP/8e5a4116-c96a-4d3e-9bbf-6efb852b5d88/sharepoint-online-12398-http-3551925972-2454031572124671254012489-429-503?forum=sharepointsupportteamja</a></p><p>タイトル : [再改訂版] SharePoint Online HTTP 調整 (応答コード : 429) 対策の増分バックオフ リトライ<br>アドレス : <a href="https://social.msdn.microsoft.com/Forums/sqlserver/ja-JP/21e2a628-44be-4541-bca9-b81c484ff59b/20877259133533029256-sharepoint-online-http-3551925972?forum=sharepointsupportteamja" target="_blank" rel="noopener">https://social.msdn.microsoft.com/Forums/sqlserver/ja-JP/21e2a628-44be-4541-bca9-b81c484ff59b/20877259133533029256-sharepoint-online-http-3551925972?forum=sharepointsupportteamja</a></p><p>タイトル : jpspsupport/CSOMRetrySample<br>アドレス : <a href="https://github.com/jpspsupport/CSOMRetrySample" target="_blank" rel="noopener">https://github.com/jpspsupport/CSOMRetrySample</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;p&gt;HTTP 調整リトライ ロジックを実装した際に、特に弊社公開記事に記載されたカスタムコードを変更している場合は、論理テストを実施していただく
      
    
    </summary>
    
    
    
      <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>PnP PowerShell でテナントのフルコントロール権限を使用して接続する方法について</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/pnp-powershell-with-app-only-token/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/pnp-powershell-with-app-only-token/</id>
    <published>2020-05-20T15:00:00.000Z</published>
    <updated>2021-03-29T12:33:29.760Z</updated>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>テナント管理者として、PowerShell でテナント全体のサイト コンテンツに対し、何らかの操作を実施しようとした際には、アクセス権の問題が頻繁に浮上します。</p><p>Office 365 管理センターで指定した全体管理者または SharePoint 管理者の権限がある場合、あらゆる設定を実施することは可能です。<br>しかし、サイト コレクション管理者を別の管理者に委任している場合、自身に該当サイトの管理者権限が与えられていないと、そのままの状態でサイトの変更をしたりコンテンツを閲覧できるわけではありません。</p><img src="/blog/sharepoint-online/pnp-powershell-with-app-only-token/SiteCollectionAdminImage.png"><p>このような状況においては、何かテナント単位で各サイトに対する作業を実施しようとした際に、一時的に自分に各サイト コレクションの管理者権限を付与してから作業せざるを得ない状況に陥ります。SharePoint 管理ポータルや、Set-SPOUser -IsSiteCollectionAdmin $true などで設定は可能です。<br>しかし、多くのサイト コレクションの列挙など、一般的にこの追加実装や作業は、時間がかかることが予測されます。</p><h1 id="対処策"><a href="#対処策" class="headerlink" title="対処策"></a>対処策</h1><p>アプリ専用トークンを使用して、アプリにテナントに対する管理者権限を割り当てることができます。手順は以下のサイトにも記載があります。より詳細な情報については確認ください。</p><p>タイトル : SharePoint アプリ専用のアクセスを許可する<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/solution-guidance/security-apponly-azureacs" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/sharepoint/dev/solution-guidance/security-apponly-azureacs</a></p><h2 id="手順"><a href="#手順" class="headerlink" title="手順"></a>手順</h2><h3 id="1-ブラウザーで-https-tenant-sharepoint-com-layouts-15-appregnew-aspx-を呼び出します。"><a href="#1-ブラウザーで-https-tenant-sharepoint-com-layouts-15-appregnew-aspx-を呼び出します。" class="headerlink" title="1) ブラウザーで https://{tenant}.sharepoint.com/_layouts/15/appregnew.aspx を呼び出します。"></a>1) ブラウザーで https://{tenant}.sharepoint.com/_layouts/15/appregnew.aspx を呼び出します。</h3><p>{tenant} の部分は、ご利用のテナント プリフィックスに基づいたアドレスに変えてください。</p><h4 id="イメージ"><a href="#イメージ" class="headerlink" title="イメージ"></a>イメージ</h4><img src="/blog/sharepoint-online/pnp-powershell-with-app-only-token/appregnew.png"><p> 1-1) クライアント ID とクライアント シークレットにて、それぞれ [生成] をクリックします。<br> 1-2) タイトルに任意の名前をしています。<br> 1-3) アプリドメインとリダイレクト先の URI には、指定のようにダミー値を記載します。<br>  (サーバー利用しませんので、ダミーで問題ありません。)<br> 1-4) [作成] をクリックします。<br> <strong>1-5) 次の画面で表示されるアプリの情報を厳重に保管してください。</strong></p><h3 id="2-次にブラウザーで-https-tenant-admin-sharepoint-com-layouts-15-appinv-aspx-を呼び出します。"><a href="#2-次にブラウザーで-https-tenant-admin-sharepoint-com-layouts-15-appinv-aspx-を呼び出します。" class="headerlink" title="2) 次にブラウザーで https://{tenant}-admin.sharepoint.com/_layouts/15/appinv.aspx を呼び出します。**"></a>2) 次にブラウザーで https://{tenant}-admin.sharepoint.com/_layouts/15/appinv.aspx を呼び出します。**</h3><p> 2-1) アプリ ID に、先ほど登録したクライアント ID を入力して、アプリの情報を呼び出します。<br> 2-2) アプリのアクセス許可を付与するために XML を記載します。</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">AppPermissionRequests</span> <span class="attr">AllowAppOnlyPolicy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">AppPermissionRequest</span> <span class="attr">Scope</span>=<span class="string">"http://sharepoint/content/tenant"</span> <span class="attr">Right</span>=<span class="string">"FullControl"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">AppPermissionRequests</span>&gt;</span></span><br></pre></td></tr></table></figure><p> 2-3) [作成] をクリックします。 </p><h4 id="イメージ-1"><a href="#イメージ-1" class="headerlink" title="イメージ"></a>イメージ</h4><img src="/blog/sharepoint-online/pnp-powershell-with-app-only-token/appinv.png"><p> 2-4) [信頼する] をクリックします。</p><h4 id="イメージ-2"><a href="#イメージ-2" class="headerlink" title="イメージ"></a>イメージ</h4><img src="/blog/sharepoint-online/pnp-powershell-with-app-only-token/appinv2.png"><p> 2-5) テナントでレガシーのアプリ専用トークンを有効化します。<br>   2020 年夏頃以降に新規作成したテナントにおいて、アプリ専用トークンが既定で無効化されている場合があります。その場合は <a href="https://support.microsoft.com/ja-jp/office/c16941c3-19b4-4710-8056-34c034493429" target="_blank" rel="noopener">SharePoint Online 管理シェル</a> を使用してテナントの設定を変更ください。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-SPOTenant -DisableCustomAppAuthentication <span class="literal">$FALSE</span></span><br></pre></td></tr></table></figure><h3 id="3-PnP-PowerShell-で以下のように接続します。後は、続けてコマンドレットを実行ください。"><a href="#3-PnP-PowerShell-で以下のように接続します。後は、続けてコマンドレットを実行ください。" class="headerlink" title="3) PnP PowerShell で以下のように接続します。後は、続けてコマンドレットを実行ください。"></a>3) PnP PowerShell で以下のように接続します。後は、続けてコマンドレットを実行ください。</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connect-PnPOnline https://&#123;tenant&#125;.sharepoint.com -ClientId &lt;クライアント ID&gt; -ClientSecret &lt;クライアント シークレット&gt;</span><br></pre></td></tr></table></figure><h1 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h1><p>アプリ専用トークンは、非常に強力です。しかし、クライアント ID やシークレットとなる情報に尽きましては、管理者アカウント・パスワードと同様、厳重に管理してくださいますようお願いします。</p><h1 id="その他"><a href="#その他" class="headerlink" title="その他"></a>その他</h1><p>Get-PnPContext コマンドを実行することで、ClientContext オブジェクトを取得できるため、このオブジェクトから利用できる様々な処理を実行することが可能です。<br>運用シナリオに応じて、CSOM 標準で用意されているコマンドレットとは別の処理を実行することができます。</p><h1 id="参考リンク"><a href="#参考リンク" class="headerlink" title="参考リンク"></a>参考リンク</h1><p>タイトル : SharePoint PnP の位置づけ<br>アドレス : <a href="https://social.msdn.microsoft.com/Forums/ja-JP/f19d79d3-c6e4-4914-9a8b-580c5efdbf9e/sharepoint-pnp1239820301326222018412369?forum=sharepointsupportteamja" target="_blank" rel="noopener">https://social.msdn.microsoft.com/Forums/ja-JP/f19d79d3-c6e4-4914-9a8b-580c5efdbf9e/sharepoint-pnp1239820301326222018412369?forum=sharepointsupportteamja</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;p&gt;テナント管理者として、PowerShell でテナント全体のサイト コンテンツに対し、何らかの操作を実施しようとした際には、アクセス権の問題
      
    
    </summary>
    
    
    
      <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>SharePoint Online でモダン エクスペリエンスを利用するメリット</title>
    <link href="https://jpspsupport.github.io/blog/sharepoint-online/modern-experience-advantage/"/>
    <id>https://jpspsupport.github.io/blog/sharepoint-online/modern-experience-advantage/</id>
    <published>2020-04-20T15:00:00.000Z</published>
    <updated>2021-03-29T12:33:29.760Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>この記事は、<a href="https://social.msdn.microsoft.com/Forums/ja-JP/0b9b82cb-9826-4387-942b-954b68602128/sharepoint-online-?forum=sharepointsupportteamja" target="_blank" rel="noopener">以前の SharePoint サポート フォーラムの投稿</a>を移行したものです。元の記事の最新の更新情報については、本内容をご参照ください。</p></blockquote><p>SharePoint Online は複数の機能において、現在モダン エクスペリエンス/クラシック エクスペリエンスの 2 種類を提供しています。</p><p>クラシック エクスペリエンスを廃止する予定は現時点ではありませんが、SharePoint Online においてはモダン エクスペリエンスの利用を推奨しています。</p><p>今回はモダン エクスペリエンスが推奨される背景を紹介します。今後 SharePoint Online を快適にご利用頂くためにはモダン エクスペリエンスの利用を推奨していますので、本稿の内容を参考に、モダン エクスペリエンスの採用や移行を検討いただけると幸いです。</p><br><h2 id="モダン-エクスペリエンスが提供された背景"><a href="#モダン-エクスペリエンスが提供された背景" class="headerlink" title="モダン エクスペリエンスが提供された背景"></a>モダン エクスペリエンスが提供された背景</h2><p>SharePoint はオンプレミス向けのサービスとして提供が開始されており、SharePoint Online はオンプレミス向けの SharePoint をベースに、クラウドの SaaS サービスとして提供が開始されました。</p><p>その後、Office 365 の普及に伴い SharePoint Online の利用者も大きく増加しています。データセンターも規模が拡大しており、SharePoint Online が稼働するインフラもサービス開始時とは大きく異なっています。</p><br><p>オンプレミス向けの SharePoint は主にイントラネットでの利用が想定されており、サーバーの台数も一般的には数台から十数台程度となりますが、複数のテナントでインフラを共有する SharePoint Online は大多数のサーバーで稼働しています。</p><p>この様なインフラの違いが影響し、SharePoint Online でオンプレミス向け SharePoint をベースに提供された機能を利用していると、パフォーマンスに影響が生じる事例が散見されるようになりました。</p><p>具体例として、オンプレミス向け SharePoint は主にフロントエンドサーバーのキャッシュを利用してパフォーマンスを維持していましたが、大多数のサーバーで稼働する SharePoint Online ではアクセスが毎回異なるサーバーに分散され、前と同じサーバーにルーティングされる可能性が極めて低いため、フロントエンドサーバーが保持するキャッシュがほとんどヒットしません。</p><p>キャッシュが利用できないため、フロントエンドサーバーやバックエンドデータベースの処理量増加により負荷が大きくなり、テナントのパフォーマンスが劣化した事例が多数あります。</p><p>従来のオンプレミス向けのアーキテクチャではクラウドのインフラでパフォーマンスを維持することが困難となったため、クラウドのインフラに最適化された設計で開発されたのがモダン エクスペリエンスとなります。</p><br><h2 id="モダン-エクスペリエンスが推奨される理由"><a href="#モダン-エクスペリエンスが推奨される理由" class="headerlink" title="モダン エクスペリエンスが推奨される理由"></a>モダン エクスペリエンスが推奨される理由</h2><p>SharePoint Online はマルチテナント型の SaaS サービスです。つまり、複数のテナントによってインフラが共有されています。<br>また、開発が継続されているため、各テナントに変更が都度反映されています。</p><p>このため、データセンター側の負荷状況の予測は非常に困難となっています。</p><p>モダン エクスペリエンスは、サーバー側の負荷状況の変動が影響しにくいように、以下の様な要素が取り入れられています。</p><br><ul><li><p>CDN</p><ul><li>静的コンテンツを Office 365 サーバーとは異なるプロキシにキャッシュし、サーバーの負荷を軽減します。</li></ul></li><li><p>クライアントサイド指向</p><ul><li>サーバー側の処理を極力シンプルにし、クライアント側でビジネスロジックを実行します。</li></ul></li><li><p>マイクロサービスアーキテクチャ</p><ul><li>1 つのアプリケーションを、独立した小さいサービスの集合で構成する設計指針。スケーリングが容易で、単一のサービスに問題が生じてもアプリケーション全体に影響が生じにくくなります。</li></ul></li></ul><br>また、モダン エクスペリエンスは引き続き積極的に開発されているため、機能の追加や修正が積極的に実施されていることも、モダン エクスペリエンスを採用するメリットとなります。<p>クラシック エクスペリエンスはレガシーな基盤である ASP.NET を利用しているため、新しい機能の追加や既存機能の修正が困難となっています。</p><br>なお、上述の通りクラシック エクスペリエンスが廃止されるアナウンスは現時点ではありませんので、この点についてはご安心ください。<p>しかし、クラシック エクスペリエンスにおいてはパフォーマンスに関する考慮事項が多くあるので、特に多くのユーザーによって利用されるクラシック エクスペリエンスのサイトにおいては、弊社公開情報を参考にパフォーマンスチューニングを実施することを強く推奨します。</p><p>タイトル : SharePoint Online のパフォーマンスをチューニングする<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/office365/enterprise/tune-sharepoint-online-performance" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office365/enterprise/tune-sharepoint-online-performance</a></p><p>タイトル : SharePoint Online ポータル パフォーマンス ガイダンス<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/dev/solution-guidance/portal-performance" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/sharepoint/dev/solution-guidance/portal-performance</a></p><br><h2 id="クラッシック-モダンエクスペリエンスの対応"><a href="#クラッシック-モダンエクスペリエンスの対応" class="headerlink" title="クラッシック/モダンエクスペリエンスの対応"></a>クラッシック/モダンエクスペリエンスの対応</h2><p>各機能のクラシック エクスペリエンス/モダン エクスペリエンスの対応を紹介します。</p><table><thead><tr><th align="left">クラッシック エクスペリエンス</th><th align="left">モダン エクスペリエンス</th></tr></thead><tbody><tr><td align="left">チームサイト、発行ポータル、など</td><td align="left">モダンチームサイト、コミュニケーションサイト、ハブサイトなど</td></tr><tr><td align="left">サンドボックス ソリューション<br>スクリプト エディター/コンテンツ エディター Web パーツ</td><td align="left">SharePoint Framework</td></tr><tr><td align="left">アンケートリスト</td><td align="left">Microsoft Forms</td></tr><tr><td align="left">タスクリスト</td><td align="left">Microsoft Planner</td></tr><tr><td align="left">予定表リスト</td><td align="left">Outlook Calendar (Office 365 Groups)</td></tr><tr><td align="left">ニュース（サイト）フィード、ディスカッション掲示板</td><td align="left">Yammer</td></tr><tr><td align="left">SharePoint ワークフロー</td><td align="left">Microsoft Flow (Power Automate)</td></tr><tr><td align="left">InfoPath</td><td align="left">Microsoft PowerApps</td></tr></tbody></table><br>モダン エクスペリエンスはクラシック エクスペリエンスの機能を完全に包括するものではありませんが、モダン エクスペリエンスでのみ実現可能なことも多数あります。<p>一例として、クラシック エクスペリエンスで慎重に考慮する必要があったリストビューのしきい値が、モダン エクスペリエンスでは抵触しにくくなっています。</p><p>これは新しいアーキテクチャによって最適化されたデータアクセスを実現しているため、しきい値自体は存在するものの、多くの場合に抵触しにくい実装となっています。</p><p>本稿ではそれぞれの差異についての紹介は割愛しますが、是非動作をご確認いただき、長期的に SharePoint Online を快適にご利用頂くためには、モダン エクスペリエンスの採用を検討いただけると幸いです。</p><br><p><em>追記</em></p><p>SharePoint Online でモダン エクスペリエンスをご利用いただく際のガイダンスとなる情報が公開されました。</p><p>タイトル : SharePoint でのモダンな機能のガイド<br>アドレス : <a href="https://docs.microsoft.com/ja-jp/sharepoint/guide-to-sharepoint-modern-experience" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/sharepoint/guide-to-sharepoint-modern-experience</a></p><p>モダン エクスペリエンスをご利用を検討される場合、こちらの情報も事前にご確認いただけると幸いです。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;この記事は、&lt;a href=&quot;https://social.msdn.microsoft.com/Forums/ja-JP/0b9b82cb-9826-4387-942b-954b68602128/sharepoint-online-?forum=
      
    
    </summary>
    
    
    
      <category term="SharePoint Online" scheme="https://jpspsupport.github.io/blog/tags/SharePoint-Online/"/>
    
  </entry>
  
  <entry>
    <title>SharePoint Support チームのブログへようこそ</title>
    <link href="https://jpspsupport.github.io/blog/general/welcome/"/>
    <id>https://jpspsupport.github.io/blog/general/welcome/</id>
    <published>2020-04-13T15:00:00.000Z</published>
    <updated>2021-03-29T12:33:29.756Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本記事は Technet Blog の更新停止に伴い、もともとばらばらに存在していた記事を一つのブログに集約／移行したものです。<br>元の記事の最新の更新情報については、本ブログの投稿をご参照ください。</p></blockquote><p>こんにちは。<br>SharePoint Support チームのブログです。</p><p>わたしたちサポートチームでは下記の製品のサポートを行っており、それぞれの製品に関する情報を本ブログで発信していきたいと考えています。</p><ul><li>SharePoint Online と OneDrive for Business</li><li>SharePoint Server (オンプレミス)</li><li>Microsoft Stream</li></ul><p>なお、本ブログは弊社の公式見解ではなく、予告なく変更される場合があります。<br>もし公式な見解が必要な場合は、弊社ドキュメント (<a href="https://docs.microsoft.com/" target="_blank" rel="noopener">https://docs.microsoft.com/</a> や <a href="https://support.microsoft.com" target="_blank" rel="noopener">https://support.microsoft.com</a>) をご参照いただく、もしくは私共サポートまでお問い合わせください。</p><p>本情報が少しでも皆様のお役に立てば幸いです😊</p><p>※過去のブログ記事は以下にアーカイブされております。<br>過去の記事を参照いただく際は、それぞれのリンク先から検索ください。<br>元の記事の最新の更新情報については、本ブログに掲載いたします。</p><ul><li><a href="https://social.msdn.microsoft.com/Forums/ja-JP/home?forum=sharepointsupportteamja" target="_blank" rel="noopener">以前の SharePoint サポート フォーラムの投稿</a></li><li><a href="https://docs.microsoft.com/en-us/archive/blogs/sharepoint_support/" target="_blank" rel="noopener">以前の Japan SharePoint Support Team Blog</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;本記事は Technet Blog の更新停止に伴い、もともとばらばらに存在していた記事を一つのブログに集約／移行したものです。&lt;br&gt;元の記事の最新の更新情報については、本ブログの投稿をご参照ください。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;
      
    
    </summary>
    
    
    
  </entry>
  
</feed>
